<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Créer son premier package</title>
    <meta charset="utf-8" />
    <meta name="author" content="Maël THEULIERE - Juliette ENGELAERE-LEFEBVRE" />
    <meta name="date" content="2020-12-21" />
    <link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
    <script src="libs/anchor-sections/anchor-sections.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Créer son premier package
### Maël THEULIERE - Juliette ENGELAERE-LEFEBVRE
### 2020-12-21

---










---
# Objectif de cet séquence

Après cet atelier vous saurez :

  -  comprendre ce qu’est un package
  
  -  comprendre la structure d’un package

  -  créer votre premier package

  -  créer le site pkgdown de votre package

---
class: inverse, center, middle

# Qu'est ce qu'un package ?

---
# Qu'est ce qu'un package ?

En R, un package est le moyen le plus adapté pour étendre les fonctionnalités de R. 

Un package est une collection de fonctions, de données, de documentations et de tests. 

Un package est facilement partageable avec d'autres.

Un package est le plus souvent versionné, c'est à dire qu'il peut exister plusieurs versions d'un même package pas forcément compatibles entre elles.

---
# Qu'est ce qu'un package ?

Un package peut être hébergé sur le CRAN ou sur une forge logiciel comme github ou gitlab.

Quand il est sur le cran, la fonction `install.packages()` permet de l'installer.


```r
install.packages("mon_package")
```

Quand il est sur une forge, on utilise les fonctions du package `{remotes}` pour les installer.
Dans ce cas, il faut lui spécifier la forge et l'adresse relative de ce package.

Exemples : 


```r
remotes::install_github("auteur_du_package/son_package")
```


```r
remotes::install_gitlab("auteur_du_package/son_package")
```
---
class: inverse, center, middle

# Structure d'un package
---
### Structure d'un package
# La structure minimale d'un package

La structure d'un package va différer suivant le contenu de celui ci. 

La structure minimale de celui va consister en : 

.pull-left[
- un fichier `DESCRIPTION` qui contient la description d'un package et ses dépendances, c'est à dire la liste des packages qui seront nécessaires pour faire fonctionner ce package

- un répertoire `R/` qui contient les fichiers sources des fonctions du package

- un fichier `NAMESPACE` qui contient les fonctions exportées par le package et la liste des fonctions importées d'autres packages. Ce fichier est généré automatiquement

- un répertoire `man/` qui contient la documentation des fonctions du package. Son contenu est généré automatiquement

]

.pull-right[
![](www/package_structure.png)

]

---
### Structure d'un package
# Le fichier DESCRIPTION

.pull-left[
Le fichier `DESCRIPTION`  contient : 

- la description du package (nom, auteur, licence, version...)

- la liste des packages qui seront nécessaires pour faire fonctionner ce package (rubrique `Imports`)

]

.pull-right[
![](www/description.png)
]

---
### Structure d'un package
# Le répertoire R/

.pull-left[
Le répertoire `R/` contient les fichiers sources des fonctions du package. 

Conseil pour bien commencer : créer un fichier R pour chaque fonction nommé de la même façon que la fonction.
]

.pull-right[
![](www/dossier_r.png)
]
---
### Structure d'un package
# Le répertoire R/


.pull-left[
Chaque fichier R contient :

- la définition de la fonction en R

- le code roxygen qui permettent de construire la documentation et de définir les dépendances de la fonction. Le code roxygen commence toujours par `#'`

]

.pull-right[
![](www/fonction_r.png)
]

---
### Structure d'un package
# Le fichier NAMESPACE
.pull-left[
Le fichier `NAMESPACE` contient : 

- les fonctions exportées par le package 

- la liste des fonctions importées d'autres packages utilisées dans notre package

Ce fichier est généré automatiquement grâce à Roxygen.
]

.pull-right[
![](www/namespace.png)
]

---
### Structure d'un package
# Le répertoire man

.pull-left[
Le répertoire `man/`  contient la documentation des fonctions du package. 

Pour chaque fonction, il contient un fichier `.Rd` qui sera la documentation de la fonction consultable dans l'aide de R.

Son contenu est généré automatiquement grâce à Roxygen.
]
.pull-right[
![](www/man_rep.png)
]


---
### Structure d'un package
# Le répertoire man

.pull-left[
Le répertoire `man/`  contient la documentation des fonctions du package. 

Pour chaque fonction, il contient un fichier `.Rd` qui sera la documentation de la fonction consultable dans l'aide de R.

Son contenu est généré automatiquement grâce à Roxygen.
]
.pull-right[
![](www/rd_file.png)
]
---
classe: inverse, center, middle
# Créer son premier package
---
### Créer son premier package
# Vos compagnons pour créer et développer votre package

.left-column[
![](www/packagescompagnons.png)
]

.right-column[
4 packages vous seront indispensables pour développer vos packages : 
- `{devtools}` recense les fonctions qui seront utilisées pour compiler ou installer votre package.
- `{usethis}`  contient un ensemble de fonctions qui vous permetront d'automatiser la plupart des tâches dont vous aurez besoin.
- `{roxygen2}` vous permettra de documenter vos fonctions (cf atelier 2).
- `{testthat}` vous permettra de tester vos fonctions. C'est à dire de définir un ensemble d'instructions qui vous permettront de vérifier que vos fonctions produise bien le résultat attendu (cf atelier 2).

Pour installer ces packages :


```r
install.packages(c('devtools','usethis','roxygen2','testthat'))
```
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
